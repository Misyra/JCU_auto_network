# 校园网自动认证工具 - 简化命令行版本

## 概述

`app_cli.py` 是校园网自动认证工具的简化命令行版本，启动后自动进入后台监控模式。

## 特性

- 🚀 **一键启动** - 无需复杂参数，直接启动监控
- ⚙️ **配置简单** - 只需修改 `.env` 文件
- 📊 **详细日志** - 控制台和文件双重日志输出
- 🔄 **自动监控** - 持续监控网络状态并自动重连
- 🛡️ **智能重试** - 失败冷却机制，避免频繁重试

## 快速开始

### 1. 配置认证信息

复制 `.env.example` 为 `.env` 并修改配置：

```bash
# 复制配置文件
copy .env.example .env
```

编辑 `.env` 文件：
```bash
# 校园网认证信息（必填）
CAMPUS_USERNAME=你的学号@cmcc
CAMPUS_PASSWORD=你的密码
CAMPUS_AUTH_URL=http://172.29.0.2

# 其他配置保持默认即可
HEADLESS=true
CHECK_INTERVAL=240
LOG_LEVEL=INFO
```

### 2. 启动监控

```powershell
# 直接启动，自动进入监控模式
python app_cli.py
```

就这么简单！程序会：
- ✅ 自动检查配置
- 🔄 启动网络监控
- 📝 输出详细日志
- 🛡️ 自动处理网络异常

## 运行效果

启动后会看到类似输出：

```
校园网自动认证工具 - 简化命令行版本
正在检查配置...
✅ 配置检查通过
用户名: 202012345@cmcc
认证地址: http://172.29.0.2

正在启动监控...
==================================================
校园网自动认证工具 - 后台监控模式
==================================================
用户名: 202012345@cmcc
认证地址: http://172.29.0.2
检测间隔: 240秒
日志文件: logs/campus_auth.log
按 Ctrl+C 停止监控
==================================================
[10:30:15] 第1次网络检测
[10:30:16] ✅ 网络连接正常
[10:30:16] ⏰ 下次检测时间: 10:34:16
```

## 配置说明

### 必填配置

| 配置项 | 说明 | 示例 |
|--------|------|------|
| `CAMPUS_USERNAME` | 校园网用户名（含运营商后缀） | `202012345@cmcc` |
| `CAMPUS_PASSWORD` | 校园网密码 | `your_password` |
| `CAMPUS_AUTH_URL` | 认证页面地址 | `http://172.29.0.2` |

### 可选配置

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| `HEADLESS` | 无头模式（推荐true） | `true` |
| `CHECK_INTERVAL` | 检测间隔（秒） | `240` |
| `LOG_LEVEL` | 日志级别 | `INFO` |
| `LOG_FILE_PATH` | 日志文件路径 | `logs/campus_auth.log` |

## 运营商后缀

根据你的网络运营商选择对应后缀：

- 移动：`@cmcc`
- 联通：`@unicom` 
- 电信：`@telecom`
- 校园网：`@xyw`

## 停止监控

按 `Ctrl+C` 停止监控，程序会显示运行统计：

```
==================================================
监控已停止，总运行时间: 02:15:30
总检测次数: 23
==================================================
```

## 后台运行

### Windows PowerShell

```powershell
# 后台启动
Start-Process -NoNewWindow python -ArgumentList "app_cli.py"

# 或创建批处理文件
echo "python app_cli.py" > start_monitor.bat
```

### 查看日志

```powershell
# 实时查看日志
Get-Content logs/campus_auth.log -Wait
```

## 常见问题

### Q: 提示配置错误怎么办？

A: 检查 `.env` 文件是否存在，以及必填配置是否正确填写。

### Q: 网络检测失败怎么办？

A: 程序会自动重试登录，如果连续失败会进入冷却期。检查：
- 用户名密码是否正确
- 认证地址是否可访问
- 网络连接是否正常

### Q: 如何修改检测间隔？

A: 在 `.env` 文件中修改 `CHECK_INTERVAL` 值（单位：秒）。

### Q: 如何查看详细日志？

A: 修改 `.env` 中的 `LOG_LEVEL=DEBUG`，重启程序。

## 与GUI版本对比

| 特性 | GUI版本 | CLI简化版 |
|------|---------|----------|
| 启动方式 | 双击运行 | 命令行启动 |
| 配置方式 | 界面设置 | .env文件 |
| 参数复杂度 | 界面选择 | 无需参数 |
| 资源占用 | 较高 | 极低 |
| 适用场景 | 桌面使用 | 服务器/后台 |

---

**简单三步，开始使用：**
1. 复制 `.env.example` 为 `.env`
2. 填写用户名和密码
3. 运行 `python app_cli.py`